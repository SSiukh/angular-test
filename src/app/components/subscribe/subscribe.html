<section class="subscribe">
  <app-loader [isLoading]="isLoading" background="#ffcd4e" />
  <div class="container">
    <div class="subscribe-wrapper">
      <div class="text-block">
        <h2 class="title">
          Щотижневі <br />
          новини
        </h2>
        <p class="subtitle">Підпишіться, щоб отримувати листи</p>
      </div>
      <div class="form-block">
        <form class="form" [formGroup]="subscribeForm" (ngSubmit)="onSubmit(modalContent)">
          <input
            class="email-input"
            id="email"
            type="email"
            placeholder="Ваш email"
            formControlName="email"
          />
          @if(email?.errors?.['required'] && submitted) {
          <p class="error">Поле не може бути порожнім</p>
          } @if(email?.errors?.['email'] && email?.touched) {
          <p class="error">Неправильний формат електронної пошти</p>
          } @if(email?.hasError('emailExists') && email?.touched) {
          <p class="error">Ця адреса вже використовується</p>
          }
          <app-button
            [isDisabled]="isLoading"
            text="Підписатись"
            [width]="width < 520 ? 184 : 294"
            [height]="width < 520 ? 48 : 64"
          ></app-button>
        </form>
        <p class="sample">
          Даю згоду на обробку та @if(width > 768) {
          <br />
          } використання персональних даних
        </p>
      </div>
    </div>
  </div>
  <ng-template #modalContent let-modal>
    <div class="overlay">
      <div class="modal">
        <div class="modal-header">
          <h4 class="modal-title">Дякуємо</h4>
          <button
            class="modal-close-btn"
            type="button"
            aria-label="Close"
            (click)="modal.dismiss()"
          >
            <app-svg-icon
              icon="close-button"
              [svgWidth]="width < 768 ? 16 : 37.59"
              [svgHeight]="width < 768 ? 16 : 36"
            ></app-svg-icon>
          </button>
        </div>
        <p class="modal-text">
          Ми відправили лист на вашу пошту. @if(width > 768) {
          <br />
          } Будь ласка, підтвердіть підписку.
        </p>
        <app-button
          text="ОК"
          [width]="width < 520 ? 184 : 192"
          [height]="width < 520 ? 48 : 64"
          (click)="modal.close()"
        ></app-button>
      </div>
    </div>
  </ng-template>
</section>
